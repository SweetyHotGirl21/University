{
    "collab_server" : "",
    "contents" : "### Exercise 1\n\nremove(list = ls())\n\nstudents2008 = read.table(\"students2008.txt\", header = TRUE, dec = \",\")\nstudents2008 = students2008[c(1,4,35,36)]\nstudents2008 = na.omit(students2008)\nattach(students2008)\n\n# a)\n\npairs(students2008[,2:4], col = sex+1, pch = sex)\n\n# b) \n\nboxplot(height ~ sex)\nboxplot(weight ~ sex)\nboxplot(shoesize ~ sex)\nfemale = subset(students2008, sex == 1)\nmale = subset(students2008, sex == 0)\n\n# c)\n\ncolMeans(male)\ncolMeans(female)\n\ncov(male[,2:4])\ncov(female[,2:4])\n\n# d)\n\npercMale = (dim(male)[1])/(dim(students2008)[1])\npercMale\npercFem = (dim(female)[1])/(dim(students2008)[1])\npercFem \n\n# e)\n\nplot(height, weight, col = sex+1, pch = sex, xlim = c(150,200), ylim = c(40,110) )\nc2 = qchisq(0.95,2)\nmeanmalehei= colMeans(male)[3]\nmeanmalewei = colMeans(male)[4]\nmeanfemalehei = colMeans(female)[3]\nmeanfemalewei = colMeans(female)[4]\n\nSmale = cov(male[,3:4])\nSfemale = cov(female[,3:4])\n\nSmaleInv = solve(Smale)\naSM11 = SmaleInv[1,1]\naSM22 = SmaleInv[2,2]\naSM12 = SmaleInv[1,2]\nSfemaleInv = solve(Sfemale)\naSF11 = SfemaleInv[1,1]\naSF22 = SfemaleInv[2,2]\naSF12 = SfemaleInv[1,2]\n\nx1 = seq(150,210, le = 1000)\nx2 = seq(40,110, le = 1000)\nf = function(x1, x2)\n{\n  aSM11*(x1-meanmalehei)^2+aSM22*(x2-meanmalewei)^2+2*aSM12*(x1-meanmalehei)*(x2-meanmalewei)\n}\nz = outer(x1,x2,f)\ncontour(x1, x2, z, asp = 1, levels = c2, add = TRUE, drawlabels = FALSE)\n\nff = function(x1,x2)\n{ \n  aSF11*(x1-meanfemalehei)^2+aSF22*(x2-meanfemalewei)^2+2*aSF12*(x1-meanfemalehei)*(x2-meanfemalewei)\n}\ny = outer(x1,x2,ff)\ncontour(x1, x2, y, asp = 1, levels = c2, add = TRUE, drawlabels = FALSE)\n\nm = c(meanmalehei,meanmalewei)\nn = length(male[,3])\nsum(mahalanobis(male[,3:4],m,Smale)<=c2)/n\n# ~91,82%\n\nmf = c(meanfemalehei,meanfemalewei)\nnf = length(female[,3])\nsum(mahalanobis(female[,3:4],mf,Sfemale)<=c2)/nf\n# ~97,83%\n\n# f)\nX = as.matrix(students2008[,3:4])\nSp = ((109)/(154))*Smale+((45)/(154))*Sfemale \nx1bar = matrix(mf,2,1)\nx2bar = matrix(m,2,1)\n\nlhs = X%*%solve(Sp)%*%(x1bar-x2bar)-(0.5*t(x1bar-x2bar)%*%solve(Sp)%*%(x1bar+x2bar))[1,1]\nrhs = log(percMale/percFem)\npi1 = c(lhs>=rhs)\n\ncountFemasMale = c(students2008[1] == 1 & pi1 == FALSE)\ncountFemasFemale = c(students2008[1] == 1 & pi1 == TRUE)\ncountMaleasFem = c(students2008[1] == 0 & pi1 == TRUE)\ncountMaleasMale = c(students2008[1] == 0 & pi1 == FALSE)\n\nsum(countMaleasFem)\nsum(countMaleasMale)\nsum(countFemasFemale)\nsum(countFemasMale)\n\nAPER = ((sum(countFemasMale)+sum(countMaleasFem))/dim(students2008)[1])\nAPER\n# ~ 10.26%\n\n# g)\nX2 = as.matrix(students2008[,2:4])\nSmale2 = cov(male[,2:4])\nSfemale2 = cov(female[,2:4])\nmeanfemalesho = colMeans(female)[2]\nmeanmalesho = colMeans(male)[2]\nm2 = c(meanmalesho,meanmalehei,meanmalewei)\nmf2 = c(meanfemalesho,meanfemalehei,meanfemalewei)\nx1bar2 = matrix(m2,3,1)\nx2bar2 = matrix(mf2,3,1)\nSp2 = ((109)/(154))*Smale2+((45)/(154))*Sfemale2\nlhs2 = X2%*%solve(Sp2)%*%(x1bar2-x2bar2)-(0.5*t(x1bar2-x2bar2)%*%solve(Sp2)%*%(x1bar2+x2bar2))[1,1]\nrhs = log(percFem/percMale)\n\npi12 = c(lhs2<=rhs)\n\ncountFemasMale2 = c(students2008[1] == 1 & pi12 == FALSE)\ncountFemasFemale2 = c(students2008[1] == 1 & pi12 == TRUE)\ncountMaleasFem2 = c(students2008[1] == 0 & pi12 == TRUE)\ncountMaleasMale2 = c(students2008[1] == 0 & pi12 == FALSE)\n\nsum(countMaleasFem2)\nsum(countMaleasMale2)\nsum(countFemasFemale2)\nsum(countFemasMale2)\n\nAPER2 = (2+3)/dim(students2008)[1]\nAPER2\n# ~ 7,69%\n\n### Exercise 2\n\nrequire(utils)\npoints(expand.grid(height = seq(150,200, 0.5), weigth = seq(40, 110, 0.5)), cex = 0.1)\n\n### Exercise 3\n\n# f)\n\nstudents2009 = read.table(\"students2009.txt\", header = TRUE, dec = \",\")\nstudents2009 = students2009[c(1,4,35,36)]\nstudents2009 = na.omit(students2009)\nX3 = as.matrix(students2009[,3:4])\nX3 = matrix(as.numeric(X3), 130,2)\n\nlhs3 = X3%*%solve(Sp)%*%(x1bar-x2bar)-(0.5*t(x1bar-x2bar)%*%solve(Sp)%*%(x1bar+x2bar))[1,1]\nrhs = log(percMale/percFem)\npi3 = c(lhs3>=rhs)\n\ncountFemasMale3 = c(students2009[1] == 1 & pi3 == FALSE)\ncountFemasFemale3 = c(students2009[1] == 1 & pi3 == TRUE)\ncountMaleasFem3 = c(students2009[1] == 0 & pi3 == TRUE)\ncountMaleasMale3 = c(students2009[1] == 0 & pi3 == FALSE)\n\nsum(countMaleasFem3)\n# Anzahl der M채nner die Frauen zugeordnet wurden: 7\nsum(countMaleasMale3)\n# Anzahl der M채nner die M채nnern zugeordnet wurden: 93\nsum(countFemasFemale3)\n# Anzahl der Frauen die Frauen zugeordnet wurden: 20\nsum(countFemasMale3)\n# Anzahl der Frauen die M채nnern zugeordnet wurden: 10\nAPER3 = ((sum(countFemasMale3)+sum(countMaleasFem3))/dim(students2009)[1])\nAPER3\n\n# g) \n\nX4 = as.matrix(students2009[c(4,35,36)])\nX4 = matrix(as.numeric(X4), ,3 )\nlhs4 = X4%*%solve(Sp2)%*%(x1bar2-x2bar2)-(0.5*t(x1bar2-x2bar2)%*%solve(Sp2)%*%(x1bar2+x2bar2))[1,1]\npi4 = c(lhs4<=-rhs)\n\ncountFemasMale4 = c(students2009[1] == 1 & pi4 == FALSE)\ncountFemasFemale4 = c(students2009[1] == 1 & pi4 == TRUE)\ncountMaleasFem4 = c(students2009[1] == 0 & pi4 == TRUE)\ncountMaleasMale4 = c(students2009[1] == 0 & pi4 == FALSE)\n\nsum(countMaleasFem4)\nsum(countMaleasMale4)\nsum(countFemasFemale4)\nsum(countFemasMale4)\n\nAPER4 = ((sum(countFemasMale4)+sum(countMaleasFem4))/dim(students2009)[1])\nAPER4\n",
    "created" : 1573820410846.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2546749031",
    "id" : "B7746D69",
    "lastKnownWriteTime" : 1574358018,
    "last_content_update" : 1574358018141,
    "path" : "~/Studium/Mannheim/VWL/2019 - 2020 WS/Applied Multivariate Statistics/Assignments/Assignment10/Assignment10/Exercise1.R",
    "project_path" : "Exercise1.R",
    "properties" : {
        "notebook_format" : "word_document",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}