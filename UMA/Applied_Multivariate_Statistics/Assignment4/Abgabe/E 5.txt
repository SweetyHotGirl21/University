### Exercise 5

remove(list = ls())

outlier3dim <-
  structure(list(x1 = c(6.03715164059163, 0.658893396127709, 
                        -0.209427598650197, 1.49037743943188, 5.10139004612713, 2.52660473655032, 
                        4.08270263854686, 1.6396297328328, 2.00195903263504, 2.77458657610558, 
                        1.28741521441567, 2.16712480728223, 3.94020137996952, 3.66671226097114, 
                        5.54307038464309, 2.99996304016723), 
                 x2 = c(4.66175971455103, 
                        2.49020943909436, 0.686000191260295, 4.747219548586, 2.92391034468324, 
                        2.30272543343906, 3.35099338246828, -0.676869585898721, 5.43329622565632, 
                        3.87047176119487, 3.16424600806285, 0.828611417313106, 6.34731657802144, 
                        0.683996758387633, 4.61239921442428, 2.59789091562676), 
                 x3 = c(13.0501573302298, 3.00057699240579, 1.70373289701793, 8.9782687954901, 9.26777654464302, 
                        5.08300843101136, 11.0413483929881, 2.08137596466126, 10.9661939544758, 
                        4.31909969951773, 5.88679514311043, 4.07501107116231, 14.6272252027742, 
                        7.1921458497291, 14.5033586402903, 7.85822188801989)), 
            class = "data.frame", row.names = c(NA,-16L))
A = outlier3dim
x1 = outlier3dim$x1
x2 = outlier3dim$x2
x3 = outlier3dim$x3
boxplot(x1)
boxplot(x2)
boxplot(x3)
S = cov(outlier3dim)
Sinv = solve(S)
R = cov2cor(S)

lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
lam3 = eigen(S)$values[3]

X = scale(A, TRUE, FALSE)

y1 = X%*%eigen(S)$vectors[,1]
y2 = X%*%eigen(S)$vectors[,2]
y3 = X%*%eigen(S)$vectors[,3]
boxplot(c(y1),c(y2),c(y3))
points(3,max(y3),pch = 16 )

fab = c(rep("black",9),"red",rep("black"))
siz = c(rep(1, 9), 2, rep(1))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
