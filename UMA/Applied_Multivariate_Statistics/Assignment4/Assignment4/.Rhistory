x2 = c(4.66175971455103,
2.49020943909436, 0.686000191260295, 4.747219548586, 2.92391034468324,
2.30272543343906, 3.35099338246828, -0.676869585898721, 5.43329622565632,
3.87047176119487, 3.16424600806285, 0.828611417313106, 6.34731657802144,
0.683996758387633, 4.61239921442428, 2.59789091562676),
x3 = c(13.0501573302298, 3.00057699240579, 1.70373289701793, 8.9782687954901, 9.26777654464302,
5.08300843101136, 11.0413483929881, 2.08137596466126, 10.9661939544758,
4.31909969951773, 5.88679514311043, 4.07501107116231, 14.6272252027742,
7.1921458497291, 14.5033586402903, 7.85822188801989)),
class = "data.frame", row.names = c(NA,-16L))
A = outlier3dim
x1 = outlier3dim$x1
x2 = outlier3dim$x2
x3 = outlier3dim$x3
boxplot(x1)
boxplot(x2)
boxplot(x3)
S = cov(outlier3dim)
Sinv = solve(S)
R = cov2cor(S)
S
R
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
lam3 = eigen(S)$values[3]
X = scale(A, TRUE, FALSE)
y1 = X%*%eigen(S)$vectors[,1]
y2 = X%*%eigen(S)$vectors[,2]
y3 = X%*%eigen(S)$vectors[,3]
boxplot(c(y1),c(y2),c(y3))
points(3,max(y3),pch = 16 )
fab = c(rep("black",9),"red",rep("black"))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab)
?pairs
siz = c(rep(16, 9), 10, rep(16))
y1 = X%*%eigen(S)$vectors[,1]
y2 = X%*%eigen(S)$vectors[,2]
y3 = X%*%eigen(S)$vectors[,3]
boxplot(c(y1),c(y2),c(y3))
points(3,max(y3),pch = 16 )
fab = c(rep("black",9),"red",rep("black"))
siz = c(rep(16, 9), 10, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 11, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 12, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 13, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 14, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 15, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 17, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 18, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 19, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 20, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 21, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 22, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 21, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 1, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 2, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 3, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 4, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 5, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 6, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 7, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 8, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 9, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 10, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 11, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 12, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 13, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 14, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 15, rep(16))
pairs(~y1+y2+y3, pch = siz, asp = 1, col = fab)
siz = c(rep(16, 9), 15, rep(16))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
siz = c(rep(2, 9), 3, rep(2))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
siz = c(rep(0.2, 9), 0.3, rep(0.2))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
siz = c(rep(0.3, 9), 0.5, rep(0.3))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
siz = c(rep(1, 9), 1.5, rep(1))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
siz = c(rep(1, 9), 2, rep(1))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
round(Ee$vectors, digits = 4)
### Exercise 6
remove(list = ls())
students  = read.table(file = "students2008.txt", header = T, dec =",")
attach(students)
heightweight=data.frame(height,weight)
heightweight=na.omit(heightweight)
attach(heightweight)
m1=mean(height)
m2=mean(weight)
c2=qchisq(0.95,2)
S=cov(heightweight)
Sinv=solve(S)
a11=Sinv[1,1]
a12=Sinv[1,2]
a22=Sinv[2,2]
x1=seq(150,210,le=1000)
x2=seq(40,110,le=1000)
f=function(x1,x2)
{
a11*(x1-m1)^2+a22*(x2-m2)^2+2*a12*(x1-m1)*(x2-m2)
}
z=outer(x1,x2,f)
# a)
contour(x1,x2,z,asp=1,levels=c2,drawlabels=FALSE,lwd=2,
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,
xlab="height",ylab="weight",main="Students 2008")
reseigen=eigen(S)
lambda=reseigen$values
E=reseigen$vectors
lambda1=lambda[1]
lambda2=lambda[2]
e1=E[,1]
e2=E[,2]
arrows(m1,m2,sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda1)*e1[1]+m1,-sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda2)*e2[1]+m1,-sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
points(height,weight,pch=16)
# ii)
X = scale(heightweight, TRUE, FALSE)
S = cov(heightweight)
Ee = eigen(S)
S = matrix(c(Ee$values[1],0,0,Ee$values[2]),2,2)
Sinv = solve(S)
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
c2=qchisq(0.95,2)
x1 = seq(-40,40, le = 1000)
x2 = x1
f=function(x1,x2)
{
1/(lam1)*(x1)^2+1/lam2*(x2)^2
}
z=outer(x1,x2,f)
contour(x1,x2,z,asp=1,levels=c2,drawlabels=FALSE,lwd=2,
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,
xlab="height",ylab="weight",main="Students 2008")
reseigen=eigen(S)
lambda=reseigen$values
E=reseigen$vectors
lambda1=lambda[1]
lambda2=lambda[2]
e1=E[,1]
e2=E[,2]
m1 = 0
m2 = 0
arrows(m1,m2,sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,-sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
y1 = X%*%Ee$vectors[,1]
y2 = X%*%Ee$vectors[,2]
Y = cbind(y1,y2)
points(Y, pch = 16)
boxplot(c(y1),c(y2))
plot(y1,height, pch = 16, asp = 1)
plot(y2,height, pch = 16, asp = 1)
plot(y1, weight, pch = 16, asp = 1)
plot(y2, weight, pch = 16, asp = 1)
# b)
round(Ee$vectors, digits = 4)
round(Ee$values, digits = 4)
round(cor(y1,height), digits = 4)
round(cor(y1,weight), digits = 4)
round(cor(y2,height), digits = 4)
round(cor(y2,weight), digits = 4)
cov(y1,y2,weight,height)
Y = cbind(y1,y2)
points(Y, pch = 16)
X = scale(heightweight, TRUE, FALSE)
S = cov(heightweight)
Ee = eigen(S)
S = matrix(c(Ee$values[1],0,0,Ee$values[2]),2,2)
Sinv = solve(S)
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
c2=qchisq(0.95,2)
x1 = seq(-40,40, le = 1000)
x2 = x1
f=function(x1,x2)
{
1/(lam1)*(x1)^2+1/lam2*(x2)^2
}
z=outer(x1,x2,f)
contour(x1,x2,z,asp=1,levels=c2,drawlabels=FALSE,lwd=2,
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,
xlab="height",ylab="weight",main="Students 2008")
reseigen=eigen(S)
lambda=reseigen$values
E=reseigen$vectors
lambda1=lambda[1]
lambda2=lambda[2]
e1=E[,1]
e2=E[,2]
m1 = 0
m2 = 0
arrows(m1,m2,sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,-sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
y1 = X%*%Ee$vectors[,1]
y2 = X%*%Ee$vectors[,2]
Y = cbind(y1,y2)
points(Y, pch = 16)
boxplot(c(y1),c(y2))
boxplot(c(y1),c(y2))
points(Y, pch = 16)
f=function(x1,x2)
{
1/(lam1)*(x1)^2+1/lam2*(x2)^2
}
z=outer(x1,x2,f)
contour(x1,x2,z,asp=1,levels=c2,drawlabels=FALSE,lwd=2,
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,
xlab="height",ylab="weight",main="Students 2008")
reseigen=eigen(S)
lambda=reseigen$values
E=reseigen$vectors
lambda1=lambda[1]
lambda2=lambda[2]
e1=E[,1]
e2=E[,2]
m1 = 0
m2 = 0
arrows(m1,m2,sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,-sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
y1 = X%*%Ee$vectors[,1]
y2 = X%*%Ee$vectors[,2]
Y = cbind(y1,y2)
points(Y, pch = 16)
boxplot(c(y1),c(y2))
plot(y1,height, pch = 16, asp = 1)
plot(y2,height, pch = 16, asp = 1)
plot(y1, weight, pch = 16, asp = 1)
round(Ee$vectors, digits = 4)
round(Ee$values, digits = 4)
Ee$values[1]/sum(Ee$values)
round(Ee$values[1]/sum(Ee$values), digits = 4)
round(sum(Ee$values)/sum(Ee$values), digits = 4)
remove(list = ls())
remove(list = ls())
outlier3dim <-
structure(list(x1 = c(6.03715164059163, 0.658893396127709,
-0.209427598650197, 1.49037743943188, 5.10139004612713, 2.52660473655032,
4.08270263854686, 1.6396297328328, 2.00195903263504, 2.77458657610558,
1.28741521441567, 2.16712480728223, 3.94020137996952, 3.66671226097114,
5.54307038464309, 2.99996304016723),
x2 = c(4.66175971455103,
2.49020943909436, 0.686000191260295, 4.747219548586, 2.92391034468324,
2.30272543343906, 3.35099338246828, -0.676869585898721, 5.43329622565632,
3.87047176119487, 3.16424600806285, 0.828611417313106, 6.34731657802144,
0.683996758387633, 4.61239921442428, 2.59789091562676),
x3 = c(13.0501573302298, 3.00057699240579, 1.70373289701793, 8.9782687954901, 9.26777654464302,
5.08300843101136, 11.0413483929881, 2.08137596466126, 10.9661939544758,
4.31909969951773, 5.88679514311043, 4.07501107116231, 14.6272252027742,
7.1921458497291, 14.5033586402903, 7.85822188801989)),
class = "data.frame", row.names = c(NA,-16L))
A = outlier3dim
x1 = outlier3dim$x1
x2 = outlier3dim$x2
x3 = outlier3dim$x3
boxplot(x1)
boxplot(x2)
x1 = outlier3dim$x1
x2 = outlier3dim$x2
x3 = outlier3dim$x3
boxplot(x1)
boxplot(x1)
outlier3dim <-
structure(list(x1 = c(6.03715164059163, 0.658893396127709,
-0.209427598650197, 1.49037743943188, 5.10139004612713, 2.52660473655032,
4.08270263854686, 1.6396297328328, 2.00195903263504, 2.77458657610558,
1.28741521441567, 2.16712480728223, 3.94020137996952, 3.66671226097114,
5.54307038464309, 2.99996304016723),
x2 = c(4.66175971455103,
2.49020943909436, 0.686000191260295, 4.747219548586, 2.92391034468324,
2.30272543343906, 3.35099338246828, -0.676869585898721, 5.43329622565632,
3.87047176119487, 3.16424600806285, 0.828611417313106, 6.34731657802144,
0.683996758387633, 4.61239921442428, 2.59789091562676),
x3 = c(13.0501573302298, 3.00057699240579, 1.70373289701793, 8.9782687954901, 9.26777654464302,
5.08300843101136, 11.0413483929881, 2.08137596466126, 10.9661939544758,
4.31909969951773, 5.88679514311043, 4.07501107116231, 14.6272252027742,
7.1921458497291, 14.5033586402903, 7.85822188801989)),
class = "data.frame", row.names = c(NA,-16L))
A = outlier3dim
x1 = outlier3dim$x1
x2 = outlier3dim$x2
x3 = outlier3dim$x3
boxplot(x1)
boxplot(x2)
boxplot(x3)
Sinv = solve(S)
R = cov2cor(S)
S = cov(outlier3dim)
lam1 = eigen(S)$values[1]
boxplot(x1)
boxplot(x2)
boxplot(x3)
S = cov(outlier3dim)
Sinv = solve(S)
R = cov2cor(S)
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
lam3 = eigen(S)$values[3]
X = scale(A, TRUE, FALSE)
y1 = X%*%eigen(S)$vectors[,1]
y2 = X%*%eigen(S)$vectors[,2]
y3 = X%*%eigen(S)$vectors[,3]
boxplot(c(y1),c(y2),c(y3))
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
lam3 = eigen(S)$values[3]
X = scale(A, TRUE, FALSE)
y1 = X%*%eigen(S)$vectors[,1]
y2 = X%*%eigen(S)$vectors[,2]
y3 = X%*%eigen(S)$vectors[,3]
boxplot(c(y1),c(y2),c(y3))
points(3,max(y3),pch = 16 )
fab = c(rep("black",9),"red",rep("black"))
siz = c(rep(1, 9), 2, rep(1))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
A = outlier3dim
x1 = outlier3dim$x1
x2 = outlier3dim$x2
x3 = outlier3dim$x3
boxplot(x1)
boxplot(x2)
boxplot(x3)
S = cov(outlier3dim)
Sinv = solve(S)
R = cov2cor(S)
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
lam3 = eigen(S)$values[3]
X = scale(A, TRUE, FALSE)
y1 = X%*%eigen(S)$vectors[,1]
y2 = X%*%eigen(S)$vectors[,2]
y3 = X%*%eigen(S)$vectors[,3]
boxplot(c(y1),c(y2),c(y3))
points(3,max(y3),pch = 16 )
fab = c(rep("black",9),"red",rep("black"))
siz = c(rep(1, 9), 2, rep(1))
pairs(~y1+y2+y3, pch = 16, asp = 1, col = fab, cex = siz)
remove(list = ls())
students  = read.table(file = "students2008.txt", header = T, dec =",")
attach(students)
heightweight=data.frame(height,weight)
heightweight=na.omit(heightweight)
attach(heightweight)
m1=mean(height)
m2=mean(weight)
c2=qchisq(0.95,2)
S=cov(heightweight)
Sinv=solve(S)
a11=Sinv[1,1]
a12=Sinv[1,2]
a22=Sinv[2,2]
x1=seq(150,210,le=1000)
x2=seq(40,110,le=1000)
f=function(x1,x2)
{
a11*(x1-m1)^2+a22*(x2-m2)^2+2*a12*(x1-m1)*(x2-m2)
}
z=outer(x1,x2,f)
contour(x1,x2,z,asp=1,levels=c2,drawlabels=FALSE,lwd=2,
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,
xlab="height",ylab="weight",main="Students 2008")
siz = c(rep(1, 9), 2, rep(1))
remove(list = ls())
outlier3dim <-
structure(list(x1 = c(6.03715164059163, 0.658893396127709,
-0.209427598650197, 1.49037743943188, 5.10139004612713, 2.52660473655032,
4.08270263854686, 1.6396297328328, 2.00195903263504, 2.77458657610558,
1.28741521441567, 2.16712480728223, 3.94020137996952, 3.66671226097114,
5.54307038464309, 2.99996304016723),
x2 = c(4.66175971455103,
2.49020943909436, 0.686000191260295, 4.747219548586, 2.92391034468324,
2.30272543343906, 3.35099338246828, -0.676869585898721, 5.43329622565632,
3.87047176119487, 3.16424600806285, 0.828611417313106, 6.34731657802144,
0.683996758387633, 4.61239921442428, 2.59789091562676),
x3 = c(13.0501573302298, 3.00057699240579, 1.70373289701793, 8.9782687954901, 9.26777654464302,
5.08300843101136, 11.0413483929881, 2.08137596466126, 10.9661939544758,
4.31909969951773, 5.88679514311043, 4.07501107116231, 14.6272252027742,
7.1921458497291, 14.5033586402903, 7.85822188801989)),
class = "data.frame", row.names = c(NA,-16L))
A = outlier3dim
x1 = outlier3dim$x1
x2 = outlier3dim$x2
x3 = outlier3dim$x3
boxplot(x1)
boxplot(x2)
boxplot(x3)
S = cov(outlier3dim)
Sinv = solve(S)
R = cov2cor(S)
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
lam3 = eigen(S)$values[3]
X = scale(A, TRUE, FALSE)
y3 = X%*%eigen(S)$vectors[,3]
boxplot(c(y1),c(y2),c(y3))
y1 = X%*%eigen(S)$vectors[,1]
y2 = X%*%eigen(S)$vectors[,2]
points(3,max(y3),pch = 16 )
fab = c(rep("black",9),"red",rep("black"))
siz = c(rep(1, 9), 2, rep(1))
pairs(~y1+y2+y3, pch = 16, col = fab, cex = siz)
remove(list = ls())
students  = read.table(file = "students2008.txt", header = T, dec =",")
attach(students)
heightweight=data.frame(height,weight)
heightweight=na.omit(heightweight)
attach(heightweight)
m1=mean(height)
m2=mean(weight)
c2=qchisq(0.95,2)
S=cov(heightweight)
Sinv=solve(S)
a11=Sinv[1,1]
a12=Sinv[1,2]
a22=Sinv[2,2]
x1=seq(150,210,le=1000)
x2=seq(40,110,le=1000)
f=function(x1,x2)
{
a11*(x1-m1)^2+a22*(x2-m2)^2+2*a12*(x1-m1)*(x2-m2)
}
z=outer(x1,x2,f)
contour(x1,x2,z,asp=1,levels=c2,drawlabels=FALSE,lwd=2,
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,
xlab="height",ylab="weight",main="Students 2008")
reseigen=eigen(S)
lambda=reseigen$values
E=reseigen$vectors
lambda1=lambda[1]
lambda2=lambda[2]
e1=E[,1]
e2=E[,2]
arrows(m1,m2,sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda1)*e1[1]+m1,-sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda2)*e2[1]+m1,-sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
points(height,weight,pch=16)
X = scale(heightweight, TRUE, FALSE)
S = cov(heightweight)
Ee = eigen(S)
S = matrix(c(Ee$values[1],0,0,Ee$values[2]),2,2)
Sinv = solve(S)
lam1 = eigen(S)$values[1]
lam2 = eigen(S)$values[2]
c2=qchisq(0.95,2)
x1 = seq(-40,40, le = 1000)
x2 = seq(-30,30, le = 1000)
f=function(x1,x2)
{
1/(lam1)*(x1)^2+1/lam2*(x2)^2
}
z=outer(x1,x2,f)
contour(x1,x2,z,asp=1,levels=c2,drawlabels=FALSE,lwd=2,
cex.axis=1.5,cex.lab=1.5,cex.main=1.5,
xlab="height",ylab="weight",main="Students 2008")
reseigen=eigen(S)
lambda=reseigen$values
E=reseigen$vectors
lambda1=lambda[1]
lambda2=lambda[2]
e1=E[,1]
e2=E[,2]
m1 = 0
m2 = 0
arrows(m1,m2,sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
arrows(m1,m2,-sqrt(c2*lambda1)*e1[1]+m1,sqrt(c2*lambda1)*e1[2]+m2,lwd=2, col = "red")
arrows(m1,m2,sqrt(c2*lambda2)*e2[1]+m1,-sqrt(c2*lambda2)*e2[2]+m2,lwd=2, col = "red")
y1 = X%*%Ee$vectors[,1]
y2 = X%*%Ee$vectors[,2]
Y = cbind(y1,y2)
points(Y, pch = 16)
