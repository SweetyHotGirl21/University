remove(list = ls())
euro  = read.table(file = "Europe.txt", header = T, dec =".")
attach(euro)
europe = data.frame(euro)
europe = na.omit(europe)
numbers = cbind(CPI, UNE, INP, BOP, PRC, UN)
S = cov(numbers)
R = cor(numbers)
E = eigen(R)$vectors
X = scale(numbers, center = T, scale = T)
Yhat = X%*%E
y1hat = Yhat[,1]*(-1)
y2hat = Yhat[,2]
plot(y1hat, y2hat, type = "n", asp = 1, xlap = "PC1", ylab = "PC2")
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2")
text(y1hat, y2hat, Country)
ls(europe)
Country = ï..Country
text(y1hat, y2hat, Country)
arrows(0,0,-E[,1]*1.5,E[,2]*1.5, lwd = 2, col = "blue")
text(-E[,1]*1.7, E[,2]*1.7, c"CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
text(-E[,1]*1.7, E[,2]*1.7, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2", xlim = c(-4,3), ylim = c(-2, 4))
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2", xlim = c(-4,3), ylim = c(-2, 4))
text(y1hat, y2hat, Country)
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2", xlim = c(-4,3), ylim = c(-2, 4))
text(y1hat, y2hat, Country)
arrows(0,0,-E[,1]*1.5,E[,2]*1.5, lwd = 2, col = "blue")
text(-E[,1]*1.7, E[,2]*1.7, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2", xlim = c(-4,3.5), ylim = c(-2, 4))
text(y1hat, y2hat, Country)
arrows(0,0,-E[,1]*1.5,E[,2]*1.5, lwd = 2, col = "blue")
text(-E[,1]*1.7, E[,2]*1.7, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2", xlim = c(-4,3), ylim = c(-2, 4))
text(y1hat, y2hat, Country)
arrows(0,0,-E[,1]*1.5,E[,2]*1.5, lwd = 2, col = "blue")
text(-E[,1]*1.7, E[,2]*1.7, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
Rich = data.frame(CPI = mean(CPI)
Rich = data.frame(CPI = mean(CPI))
Rich = data.frame(CPI = mean(CPI))
Rich = data.frame(CPI = mean(CPI), UNE = mean(UNE), INP = mean(INP), BOP = max(BOP)*3, PRC = mean(PRC), UN = mean(PRC))
Rich
Rich = data.frame(ï..Country = "Rich", CPI = mean(CPI), UNE = mean(UNE), INP = mean(INP), BOP = max(BOP)*3, PRC = mean(PRC), UN = mean(PRC))
Rich
rbind.data.frame(europe, Rich)
Rich = data.frame(ï..Country = "Rich", CPI = mean(CPI), UNE = mean(UNE), INP = mean(INP), BOP = max(BOP)*3, PRC = mean(PRC), UN = mean(UN))
Rich
rbind.data.frame(europe, Rich)
XRich = c(0,0,0,(3*max(BOP)-mean(BOP))/sd(BOP),0,0)
YhatRich = XRich%*%E
lot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2",ylim = c(-5,4))
text(y1hat,y2hat, Country)
text(-YhatRich[1,1],YhatRich[1,2], "Rich")
arrows(0,0,-E[,1]*2,E[,2]*2, col = "blue", lwd = 2)
text(-E[,1]*2.2,E[,2]*2.2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2",ylim = c(-5,4))
text(y1hat,y2hat, Country)
text(-YhatRich[1,1],YhatRich[1,2], "Rich")
arrows(0,0,-E[,1]*2,E[,2]*2, col = "blue", lwd = 2)
text(-E[,1]*2.2,E[,2]*2.2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
Rich = data.frame(ï..Country = "Rich", CPI = mean(CPI), UNE = mean(UNE), INP = mean(INP), BOP = max(BOP)*3, PRC = mean(PRC), UN = mean(UN))
rbind.data.frame(europe, Rich)
XRich = c(0,0,0,(3*max(BOP)-mean(BOP))/sd(BOP),0,0)
YhatRich = XRich%*%E
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2",ylim = c(-5,4))
text(y1hat,y2hat, Country)
text(-YhatRich[1,1],YhatRich[1,2], "Rich")
arrows(0,0,-E[,1]*2,E[,2]*2, col = "blue", lwd = 2)
text(-E[,1]*2.2,E[,2]*2.2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
remove(list = ls())
euro  = read.table(file = "Europe.txt", header = T, dec =".")
attach(euro)
europe = data.frame(CPI, UNE, INP, BOP, PRC, UN)
europe = na.omit(europe)
ls(europe)
x = scale(europe, center = T, scale = T)
E = eigen(R)$vectors
R = cor(europe)
E = eigen(R)$vectors
remove(list = ls())
euro  = read.table(file = "Europe.txt", header = T, dec =".")
attach(euro)
europe = data.frame(CPI, UNE, INP, BOP, PRC, UN)
europe = na.omit(europe)
ls(europe)
x = scale(europe, center = T, scale = T)
R = cor(europe)
E = eigen(R)$vectors
A1hat = X%*%E[,1]%*%t(E[,1])
X = scale(europe, center = T, scale = T)
R = cor(europe)
E = eigen(R)$vectors
A1hat = X%*%E[,1]%*%t(E[,1])
hea(A1hat,5)
head(A1hat,5)
dim(X)
AE = (dim(X)[1]-1)
AE
AE = (dim(X)[1]-1)*sum(eigen(R)$values)
AE
AE = (dim(X)[1]-1)*sum(eigen(R)$values[2:6])
AE
A2hat = X%*%E[,1:2]%*%t(E[,1:2])
head(A2hat, 5)
AE = (dim(X)[1]-1)*sum(eigen(R)$values[3:6])
AE
remove(list = ls())
euro  = read.table(file = "Europe.txt", header = T, dec =".")
attach(euro)
europe = data.frame(CPI, UNE, INP, BOP, PRC, UN)
europe = na.omit(europe)
ls(europe)
X = scale(europe, center = T, scale = T)
R = cor(europe)
E = eigen(R)$vectors
A1hat = X%*%E[,1]%*%t(E[,1])
head(A1hat,5)
AE1 = (dim(X)[1]-1)*sum(eigen(R)$values[2:6])
AE1
A2hat = X%*%E[,1:2]%*%t(E[,1:2])
head(A2hat, 5)
AE2 = (dim(X)[1]-1)*sum(eigen(R)$values[3:6])
AE2
A3hat = X%*%E[,1:3]%*%t(E[,1:3])
head(A3hat, 5)
AE3 = (dim(X)[1]-1)*sum(eigen(R)$values[4:6])
AE3
remove(list = ls())
appro = read.table(file = "Approx2dim", header = T, dec =".")
appro = read.table(file = "Approx2dim.txt", header = T, dec =".")
append(appro)
attach(appro)
Approx2 = data.frame(x1,x2)
View(appro)
View(appro)
View(appro)
x1 = ï..x1
Approx2 = data.frame(x1,x2)
Approx2 = na.omit(Approx2)
remove(list = ls())
appro = read.table(file = "Approx2dim.txt", header = T, dec =".")
attach(appro)
x1 = ï..x1
Approx2 = data.frame(x1,x2)
Approx2 = na.omit(Approx2)
reslm = lm(x2 ~ x1 - 1)
plot(x1,x2)
reslm
remove(list = ls())
appro = read.table(file = "Approx2dim.txt", header = T, dec =".")
attach(appro)
x1 = ï..x1
Approx2 = data.frame(x1,x2)
Approx2 = na.omit(Approx2)
plot(x1,x2)
reslm = lm(x2 ~ x1 - 1)
abline(reslm, col= "red")
plot(x1,x2, asp = 1, xlim = c(-4,3), ylim = c(-2, 4))
reslm = lm(x2 ~ x1 - 1)
abline(reslm, col= "red")
abline(reslm, col= "blue")
reslm = lm(x2 ~ x1 - 1)
x2hatlm = reslm$fitted.values
abline(reslm, col= "blue")
points(x1,x2hatlm, pch = 16, col = "blue")
x2hatlm = reslm$fitted.values
abline(reslm, col= "blue")
points(x1,x2hatlm, pch = 16, col = "blue")
abline(h = 0, v = 0)
S = cov(Approx2)
S = cov(Approx2)
E = eigen(S)$vectors
X = scale(Approx2, center = F, scale = T)
Ahat = X%*%E[,1]%*%t(E[,1])
reslm2 = lm(Ahat[,2] ~ Ahat[,1] -1)
remove(list = ls())
appro = read.table(file = "Approx2dim.txt", header = T, dec =".")
attach(appro)
x1 = ï..x1
Approx2 = data.frame(x1,x2)
Approx2 = na.omit(Approx2)
plot(x1,x2, asp = 1, xlim = c(-4,3), ylim = c(-2, 4))
abline(h = 0, v = 0)
reslm = lm(x2 ~ x1 - 1)
x2hatlm = reslm$fitted.values
abline(reslm, col= "blue")
points(x1,x2hatlm, pch = 16, col = "blue")
S = cov(Approx2)
E = eigen(S)$vectors
X = scale(Approx2, center = F, scale = T)
Ahat = X%*%E[,1]%*%t(E[,1])
reslm2 = lm(Ahat[,2] ~ Ahat[,1] -1)
abline(reslm2, col = "red", lwd = 2)
x2hatlm2 = reslm2$fitted.values
points(Ahat[,1], x2hatlm2, pch = 16, col ="red")
AE1 = (dim(X)[1]-1)*sum(eigen(R)$values[2])
AE1 = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE1
ED = sqrt(sum((x2-x2hatlm)^2)
# Approximation Error
AE1 = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE1
ED = sqrt(sum((x2-x2hatlm)^2))
ED
AE1 = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE
remove(list = ls())
appro = read.table(file = "Approx2dim.txt", header = T, dec =".")
attach(appro)
x1 = ï..x1
Approx2 = data.frame(x1,x2)
Approx2 = na.omit(Approx2)
plot(x1,x2, asp = 1, xlim = c(-4,3), ylim = c(-2, 4))
abline(h = 0, v = 0)
reslm = lm(x2 ~ x1 - 1)
x2hatlm = reslm$fitted.values
abline(reslm, col= "blue")
points(x1,x2hatlm, pch = 16, col = "blue")
S = cov(Approx2)
E = eigen(S)$vectors
X = scale(Approx2, center = F, scale = T)
Ahat = X%*%E[,1]%*%t(E[,1])
reslm2 = lm(Ahat[,2] ~ Ahat[,1] -1)
x2hatlm2 = reslm2$fitted.values
abline(reslm2, col = "red", lwd = 2)
points(Ahat[,1], x2hatlm2, pch = 16, col ="red")
ED = sqrt(sum((x2-x2hatlm)^2))
ED
AE = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE
plot(x1,x2, asp = 1, xlim = c(-4,3), ylim = c(-2, 4), main = "Least Squares Regression and Eigenvector Projection")
reslm$residuals
sum(reslm$residuals)
ED = sqrt(sum((x2-x2hatlm)^2))
ED
sum(abs(reslm$residuals)
ED = sqrt(sum((x2-x2hatlm)^2))
ED
# Approximation Error
AE = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE
sum(abs(reslm$residuals)
ED = sqrt(sum((x2-x2hatlm)^2))
ED
# Approximation Error
AE = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE
sum(abs(reslm$residuals))
?abs
reslm$residuals
sum(abs(reslm$residuals))
reslm$residuals
sum(abs(reslm$residuals))
sum((reslm$residuals)^2)
ED = sqrt(sum((x2-x2hatlm)^2))
ED
AE = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE
sum((reslm$residuals)^2)
sum((reslm2$residuals)^2)
sprt((sum((reslm2$fitted.values)-(Approx2)))^2)
sqrt((sum((reslm2$fitted.values)-(Approx2)))^2)
reslm2$fitted.values
c(reslm2$fitted.values,Ahat[,1])
Ahat[1]
Ahat[,1]
reslm2
reslm2$fitted.values
data.frame(Ahat[,1],x2hatlm2)
plot(data.frame(Ahat[,1],x2hatlm2))
head(ü)
ü = data.frame(Ahat[,1],x2hatlm2)
head(ü)
Ahat[,1]
sqrt((sum(ü- Approx2))^2)
(ü- Approx2)
Approx2
(Approx2 - ü)
AE = (dim(X)[1]-1)*sum(eigen(S)$values[2])
AE
sum((reslm$residuals)^2)
dim(X)[1]
remove(list = ls())
euro  = read.table(file = "Europe.txt", header = T, dec =".")
attach(euro)
europe = data.frame(euro)
europe = na.omit(europe)
ls(europe)
Country = ï..Country
numbers = cbind(CPI, UNE, INP, BOP, PRC, UN)
R = cor(numbers)
E = eigen(R)$vectors
X = scale(numbers, center = T, scale = T)
Yhat = X%*%E
y1hat = Yhat[,1]*(-1)
y2hat = Yhat[,2]
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2", xlim = c(-4,3), ylim = c(-2, 4))
text(y1hat, y2hat, Country)
arrows(0,0,-E[,1]*1.5,E[,2]*1.5, lwd = 2, col = "blue")
text(-E[,1]*2, E[,2]*2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
Rich = data.frame(ï..Country = "Rich", CPI = mean(CPI), UNE = mean(UNE), INP = mean(INP), BOP = max(BOP)*3, PRC = mean(PRC), UN = mean(UN))
rbind.data.frame(europe, Rich)
XRich = c(0,0,0,(3*max(BOP)-mean(BOP))/sd(BOP),0,0)
YhatRich = XRich%*%E
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2",ylim = c(-5,4))
text(y1hat,y2hat, Country)
text(-YhatRich[1,1],YhatRich[1,2], "Rich")
arrows(0,0,-E[,1]*2,E[,2]*2, col = "blue", lwd = 2)
text(-E[,1]*2.2,E[,2]*2.2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
remove(list = ls())
euro  = read.table(file = "Europe.txt", header = T, dec =".")
attach(euro)
europe = data.frame(CPI, UNE, INP, BOP, PRC, UN)
europe = na.omit(europe)
ls(europe)
X = scale(europe, center = T, scale = T)
R = cor(europe)
E = eigen(R)$vectors
A1hat = X%*%E[,1]%*%t(E[,1])
head(A1hat,5)
AE1 = (dim(X)[1]-1)*sum(eigen(R)$values[2:6])
AE1
A2hat = X%*%E[,1:2]%*%t(E[,1:2])
head(A2hat, 5)
AE2 = (dim(X)[1]-1)*sum(eigen(R)$values[3:6])
AE2
A3hat = X%*%E[,1:3]%*%t(E[,1:3])
head(A3hat, 5)
AE3 = (dim(X)[1]-1)*sum(eigen(R)$values[4:6])
AE3
remove(list = ls())
euro  = read.table(file = "Europe.txt", header = T, dec =".")
attach(euro)
europe = data.frame(euro)
europe = na.omit(europe)
ls(europe)
Country = ï..Country
numbers = cbind(CPI, UNE, INP, BOP, PRC, UN)
R = cor(numbers)
E = eigen(R)$vectors
X = scale(numbers, center = T, scale = T)
Yhat = X%*%E
y1hat = Yhat[,1]*(-1)
y2hat = Yhat[,2]
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2", xlim = c(-4,3), ylim = c(-2, 4))
text(y1hat, y2hat, Country)
arrows(0,0,-E[,1]*1.5,E[,2]*1.5, lwd = 2, col = "blue")
text(-E[,1]*2, E[,2]*2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
arrows(0,0,-E[,1]*1.5,E[,2]*1.5, lwd = 2, col = "blue")
text(-E[,1]*2, E[,2]*2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
Rich = data.frame(ï..Country = "Rich", CPI = mean(CPI), UNE = mean(UNE), INP = mean(INP), BOP = max(BOP)*3, PRC = mean(PRC), UN = mean(UN))
rbind.data.frame(europe, Rich)
XRich = c(0,0,0,(3*max(BOP)-mean(BOP))/sd(BOP),0,0)
YhatRich = XRich%*%E
plot(y1hat, y2hat, type = "n", asp = 1, xlab = "PC1", ylab = "PC2",ylim = c(-5,4))
text(y1hat,y2hat, Country)
text(-YhatRich[1,1],YhatRich[1,2], "Rich")
arrows(0,0,-E[,1]*2,E[,2]*2, col = "blue", lwd = 2)
text(-E[,1]*2.2,E[,2]*2.2, c("CPI","UNE","INP","BOP","PRC","UN"), col = "blue")
